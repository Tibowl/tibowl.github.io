<!doctype html>
<html>
    <head>
        <title>Flat is Justice! - KClk LSC calc</title>
        <meta name="theme-color" content="#082E6B"/>
        <meta name=viewport content="width=device-width, initial-scale=1">
        <style type="text/css">
        	div {
        		display:inline;
        	}
        </style>
    </head>
    <body>
        Fuel: <input type="number" id="fuel" min="1500" value="1500" max="7000" onchange="update();" onclick="update();"><br>
        Ammo: <input type="number" id="ammo" min="1500" value="1500" max="7000" onchange="update();" onclick="update();"><br>
        Steel: <input type="number" id="steel" min="2000" value="2000" max="7000" onchange="update();" onclick="update();"><br>
        Bauxite: <input type="number" id="baux" min="1000" value="1000" max="7000" onchange="update();" onclick="update();"><br>
        DevM: <input type="number" id="devm" min="1" value="20" max="100" onchange="update();" onclick="update();"><br>
    	<br>
        <div id="output"></div>

    	<script type="text/javascript">
/*
            if Steel >= 2800 + rn(1400) && Fuel >= 2400 + rn(1200) && Bull >= 1050 + rn(900) && Bauxite >= 2800 + rn(2400) && Dev_Kit >= 1 + rn(0))
            {
                group_id = 1;
            }
            else if Steel >= 4400 + rn(2200) && Fuel >= 2240 + rn(1120) && Bull >= 2940 + rn(2520) && Bauxite >= 1050 + rn(900) && Dev_Kit >= 20 + rn(0))
            {
                group_id = 2;
            }
            else if Steel >= 3040 + rn(1520) && Fuel >= 1920 + rn(960) && Bull >= 2240 + rn(1920) && Bauxite >= 910 + rn(780) && Dev_Kit >= 1 + rn(0))
            {
                group_id = 3;
            }
            else
            {
                group_id = 4;
            }
*/
    		function update() {
                var fuel = document.getElementById('fuel').value;
                var ammo = document.getElementById('ammo').value;
                var steel = document.getElementById('steel').value;
                var baux = document.getElementById('baux').value;
                var devm = document.getElementById('devm').value;

                console.log(fuel, ammo, steel, baux, devm);

                var chancesUsed = 0;
                var groupChanches = [0, 0, 0, 0];
                var roll = [0, 0, 0, 0], finalRoll = [];

                if(steel >= 2800 && fuel >= 2400 && ammo >= 1050 && baux >= 2800 && devm >= 1)  {
                    let c = Math.min(1, (steel - 2800 + 1) / 1400)
                            * Math.min(1, (fuel - 2400 + 1) / 1200)
                            * Math.min(1, (ammo - 1050 + 1) / 900)
                            * Math.min(1, (baux - 2800 + 1) / 2400)
                            * (1 - chancesUsed);
                    roll[0] = [((steel-4000)*0.004), ((fuel-3000)*0.003), ((ammo-2000)*0.003), ((baux-5000)*0.005), ((devm-50)*0.1)]
                    finalRoll[0] = (roll[0][0]|0) + (roll[0][1]|0) + (roll[0][2]|0) + (roll[0][3]|0) + (roll[0][4]|0); 
                    groupChanches[0] = c;
                    chancesUsed += c;
                }

                if(steel >= 4400 && fuel >= 2240 && ammo >= 2940 && baux >= 1050 && devm >= 20)  {
                    let c = Math.min(1, (steel - 4400 + 1) / 2200)
                            * Math.min(1, (fuel - 2240 + 1) / 1120)
                            * Math.min(1, (ammo - 2940 + 1) / 2520)
                            * Math.min(1, (baux - 1050 + 1) / 900)
                            * (1 - chancesUsed);
                    roll[1] = [((steel-5500)*0.004), ((fuel-3500)*0.003), ((ammo-4500)*0.005), ((baux-2200)*0.002), ((devm-60)*0.2)]
                    finalRoll[1] = (roll[1][0]|0) + (roll[1][1]|0) + (roll[1][2]|0) + (roll[1][3]|0) + (roll[1][4]|0); 
                    groupChanches[1] = c;
                    chancesUsed += c;
                }

                if(steel >= 3040 && fuel >= 1920 && ammo >= 2240 && baux >= 910 && devm >= 1)  {
                    let c = Math.min(1, (steel - 3040 + 1) / 1520)
                            * Math.min(1, (fuel - 1920 + 1) / 960)
                            * Math.min(1, (ammo - 2240 + 1) / 1920)
                            * Math.min(1, (baux - 910 + 1) / 780)
                            * (1 - chancesUsed);
                    roll[2] = [((steel-4000)*0.003), ((fuel-2500)*0.002), ((ammo-3000)*0.003), ((baux-1800)*0.002), ((devm-40)*0.2)]
                    finalRoll[2] = (roll[2][0]|0) + (roll[2][1]|0) + (roll[2][2]|0) + (roll[2][3]|0) + (roll[2][4]|0); 
                    groupChanches[2] = c;
                    chancesUsed += c;
                }

                let c = 1 - chancesUsed;

                roll[3] = [((steel-3000)*0.002), ((fuel-2000)*0.002), ((ammo-2500)*0.002), ((baux-1500)*0.002), ((devm-40)*0.2)]
                finalRoll[3] = (roll[3][0]|0) + (roll[3][1]|0) + (roll[3][2]|0) + (roll[3][3]|0) + (roll[3][4]|0); 
                groupChanches[3] = c;
                chancesUsed += c;

                console.log(groupChanches);
                console.log(roll);
                console.log(finalRoll);

    		}
    	</script>
    </body>
</html>